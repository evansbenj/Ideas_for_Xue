# Introduciton
Cap5n gene is part of an interesting stretch of the Z chromosomes. One of these copies (the cap5n.z) is only present on the Z and not the W (supposedly). This means we have an a priori expectation of expression differences between females (1 copy) and males (2 copies). The paper that originally explored these genes suggested a pattern consistent with dosage compensation (high female expression), which would be surprising.
We want to check on this against laevis transciptome.
```
>cap5n.L
CCACGACCTGGTCTGGAGGCTGATCCGCAGCGAAGAGAGTTTGGGGCTGCCGGACGGAGCAGGAGGCTGGAGCTTGTGGCTGGTCCCCCCGGGCAGACAGTGAAGAATGTTCTCCTCGGTGAAGCCGTTTGAGAACCAGCAGTACCAGGCCCTGAAGAAGGAATGTCTGAGTAAGAAGGTTCTGTTTGAGGATCCGACCTTCCCGGCCAATAACGACTCTCTCTTCTACAAGACACAGCGAGTCCAGGGGGTACAGTGGAAGCGCCCCAAGGAATTCTGCAGTGACCCTCGTCTGTTTGTGGACGGGATTAGTTCACATGATTTGCATCAAGGCCAAGTTGGAAACTGCTGGTTCATTGCCGCCTGCTCCTCCCTGGCCTCACGTGAGCAACTATGGCAGAAGGTGATTCCCGACTGGAAGGAGCAAGAGTGGTTCGCAGAAAAGCCACAAAACTACGCCGGAATTTTCCACTTCCATTTCTGGAAGTTCGGGGATTGGGTAGACGTGGTGATTGATGATCGTCTCCCTACAATCAACAATGAACTCATCTACTGCCACTCCAATGAGAAGAACGAGCTGTGGTGCGCACTGGTGGAGAAAGCTTATGCCAAATTAGCCGGGTGCTATGAAGCGTTGGATGGAGGAAATACGGCTGATGCCCTTGTGGACTTCACCGGTGGTGTCTCGGAGCCCATTGATGTCTCCGAGGGGCATTTTTCCACCGATGCAGAGAAAAGAAATGACCTTTTTGAGAGAGTCTTGAAGGTCCAAAACCGAGGAGGTCTCATCAGCTGCTCCATCAGGGCAACCTCAGCCAGTGATATGGAAGCCCGTATGGCTTGCGGCCTTGTGAAGGGTCATGCCTATGCCGTAACAGATGTGAGAAAAGTGAGGTTGGGCCACGGCTTGCTGGCCTTTTTCAAGTCAGAGAAGCTTGATATGATCCGCATGCGTAATCCGTGGGGGGAGAGAGAATGGAACGGACCTTGGAGTGACAGCTCCGAAGAGTGGCAGAAGGTGAGCAAGAGTGAGCGGGAGAAGCTGGGTGTCACCGTGCAGGACGACGGGGAGTTCTGGATGACCTTTGAGGATTTCTGCAAGTATTACACAGACATCATAATGTGCAGACTCATCAACACCTCCTACCTGAGCATCTACAAGACATGGGAGGAGGCCGTGCTGCGATCCTCTTGGACTAAACACGAGGACCCTTTGCAGAATCGCAGCGGGGGGTGCCTCAACCACAAGAGCACTTACCTTCAAAACCCACAGTTCGTGTTTGATGTAAAGAAGCCGGAAGATGAAGTTCTGGTTTGCCTCCAGCAGAAGACGAAGAGGACCACCCGGAAGGACGGCAAAGCAGAAAATCTCGCTATAGGTTTGGAAATTCACCAGGTGGAGTTGAACCGCAAGTTCCGGATGCACACCCTTCAGCCCAAAGTGGCCAGCTCCATCTACATTAACTCCCGCAGTGTCTTCCTACGTATTGACCTGAAGGAGGGGAGATACGTTGTTATTCCCACCACGTTTGATCCAGGTCACACGGAAGAATTCCTGCTCAGAATTTTTACTGATGTGCCTTCTAACTGCTGTGAACTGAAATTGGATGAACCCACCAGGACTTGTTGGTCGGGGCTATGTGGGTACCCCCAGCTGGTGTCACAGGTGCACGTGGTCTCAGCCCTGGGACTCAAGAATCAAGATTCCGACGGAGGTGCTGACCCATACGTGATTATCAGCTGTGAAGGAAACAAAGTGCAATCCCCTGTCATAAAAGACTGTTTGGAGCCGAAATTTAATGTCAAAGGCGTTTTCTACAGGAAGAAGCCTGGGCAGCCCATTGTGGTTCAGGTTTGGAATCATAACGTTATAAAGGATGAGTTCATGGGACAGGTGGTCCTTTCTGCAGACCCCAACAACCTTCAGACTCAGCACAGCCTTGAGCTTCAGAACAAGGGCAACAAGAAATCTGGCGAGATCTCAGGAACCATCAACCTTGTTCTGCTCACTAGCCAAAGCCTTACCGGGATATAACCTTTCCCCCCGGTGCCATGTATACAGGTGAAGAGCACACCCAGCCTCCACGATACCCTTGAGGTGCCTTGAGGAAAGCCGAGACCCATTGTCCCGTAGGCCTTGTTACCACCGAGATTGCATGCTCCGCTCCTGATTGTAACAATGACTGACTGTATGTTATTCACTATATTCGATTCCATATACAGAGCAGTGTCCATGTAACGTGTGAACATGTGCCAAAAAAACAGTATATCTATAGCTTAGATAGAAAGTTACCGCTAGCATTTATATTACGTCTGCTGGGGGTTCAGGCACCCAAAGCTTTGCCCACTCATTCTTTATGCGGGTGCTAACATGCAATATTCCATGTATTCTCTGGACTAAAGCAGCTCTGTTTGGTCACCATCTCAGTCTGCTCTTGGAGACCCCACTACTGTGAGATGTCACTTGCCCCTTGATGCTTAACTGTATTGCTGCAAAGCTTGGTGTTGCCATAGTGACATATTTGGGTTCATATCAATCCTATATTAAGTTATCCATACAGGAGCCATTAAAAGCTACTGACTTGGACTCCAGACCAAATCAACAGTTTATTGGCTCTTGAGTGAGGTCCTAAGGAGGGGCCTATCCAACCAATATCTACCCAAAGCCAGATACCTGTTGGGCTTCAGTCTGAACTGGCAAACCAGAAGGAGAACTTTTTAATAGTAGGATTTTTCATATTGAGAGTATTTCTCTTATGTAGAACATATCTTTAAAACTACACACGACCTGCAATGCCATTTGACCTGTCACATGTCCCTTCTTGTGCGTTTAAATGAGCAGAGGACTCTTCTATATTGATGGTAATCTTTACTTTCCCCATTCCTACAACAGGTCTTATACTGGGGTTTCTGGTTCTGCTGGATCCAGTTATACAGAGTCTATCCAAAGACGCTGGTCCAGGCCAGACTTTTGTATGATAATAAGCCTCGGGCCGTATCTAAAGGGGCTGCATTTAGCTTTTTATACATAGAATAAGGATTTAGATCCTGTAGCTCCTGTAGGGTCCTCTGGTGACCAAACTGGACTCAGGTCTCATATTTCAGAACAATCATTGGGCCCCTCATTTTGGCTTCTTCCAGGAGCCACAGTTTCTAGATCTAGTAGAGGAATGCACAAATGATAATGTACAACGTGCATGTATGTCAGCATGGGGATGTGGATATAGGACAGAAATCAACCTAAGGGCTTGCATTTGTCATGCGTCTGTTTTTAGGAGACTGAACAACAGAATTCTGCCGTGATTTTAGTTTTATGACATTTTATCCGTTTTAGGTAGTAAATAAAATGAGGTTTTAGGGAGAGAAAGAACAATCCATTTGGCCAGTAGACTTTTTCTTGTGCCAGTGCTCCTCATAGAAGGGACCAATGATCCGATTCACTGTTTGTGGACAGCCACACAGTTCTGCCTAGCGATTGGACCAATTGGCTTGTTAGCTGTGTTTCATTGGCCGATTCCCAGCACTTTGCAGCCAGCTTTGTAGTGTCCCTACATTGACTTTAATAAGCCACAAATTATATGAATGTGAGGGTCAAATGCCAAATATTTTACAATGTTTGAATGCACAATTACATATTCTGTTAAGTTCTCAATATTATTATTTTTTGAAGTTGGTCTTTAATGGCCCAACGTAGACCACCGCTATTGGCTGCTGACTTGACATCTTATTGGCTAAAAGAGATCAGAGCTGCTCAGGCTCAGAAAGATATTGGTCAACAATCTGTTGCTTAAAGACCTCATTGGATCCATTCCCAACTGGTCAATAACAACCCCCCTGTGTGATCCAGTCGCATTTTGGGTTGATGTTGCCAGTCTATTACTGCTTTTTATTCTCTCCTTGTGCCAAGTGATTTCTCTTCTATTATTTAGCACATGCAAATTGATGATGATGGTTTTATTCAGGGATGTTCAGTGTTTTATTTGGAATTTAACGTTGTGTATTTTATGGGTCTTTTTGCCTTTTTGTATCTTATTGTTTAATGATGAGTTTTACTCTCTTGTCTCCAAATCTTGTTCAAGGGGAACTTTTATATTAAACTTCTTTCTCCTTTAAAAAAAAAAAAAAAAA


>cap5n.S
CCGCAGGGGAGAGAGTTTGGGCAGTTGGACAAGAGGAGACTGAGACTGGAGTTTGTGTCTGGTTCCCCCCCGGGACAGACAGTGCAGAATGTTGTCGTCGGTGAAGCCGTTTGGGGAGCAGAAGTTCCAGACTCTGAAGAAGGAATGTCTGAGTAAGAAACTTCTGTTTGAGGATCCGACCTTCCCGGCCAATGACGCCTCTCTCTTCTACAAGACTCAGCGGGTTCAGGGGGTACAGTGGAAGCGCCCCAAGGAATTCTGCAGTGACCCTCATCTGTTTGTGGATGGAATTAGTTCACATGATTTGCATCAAGGACAAGTCGGAAACTGCTGGTTTGTTGCCGCCTGTTCCTCTTTAGCCTCACGTGAGCAACTATGGCAGAAGGTGATTCCTGAGTGGAAGGAGCAAGAGTGGTACGCGGACAGGCCGCAAAACTACGCCGGAATTTTCCACTTCCATTTCTGGAAGTTTGGGGAGTGGGTGGATGTGGTGATCGACGATCGTCTCCCTACAATCAACAATGAACTCATCTACTGCCATTCCAATGAGAAGAACGAGCTGTGGTGCGCGCTGGTGGAGAAAGCTTATGCCAAGTTAGCCGGGTGCTATGAAGCGTTGGATGGAGGAAATACAGCTGATGCCCTTGTAGACTTCACCGGTGGTGTCTCAGAGCCCACTGATATTTCTGAAGGGCATTTTTCCACCGATGCAGAGAAAAGAAATGACCTTTTTGAGAGAGTCCTGAAGGTGCACAACCGAGGAGGCCTGATCAGCTGCTCCATCAGGGCAACTGCAGCCAGTGACATGGAAGCCCGTATGGCTTGTGGCCTTGTGAAGGGCCATGCCTATGCCGTAACAGATGTGCGCAAAGTGCGACTGGGCCATGGCTTGTTGGCCTTTTTCAAGTCAGAGAAGCTTGATATGATTCGAATGCGCAATCCGTGGGGTGAGAGAGAATGGAATGGAGCCTGGAGTGACAGCTCCGAAGAGTGGCAGAAGGTGAGCAAAAGTGAGCGGGAGAAGCTGGGGGTCACCGTGCAGGATGATGGGGAGTTCTGGATGACCTTTGAGGATTTCTGCAAGTACTACACAGACATCATTATGTGCAGACTCATCAACACCTCCTACCTGAGCATCCACAAGACTTGGGAGGAGGCCGTGCTGCGATCCTCTTGGGTTAAACACGAGGACCCTTTGCAGAATCGCTGCGGGGGGTGCCTCAATTACAAGACCACTTACCTTCAGAACCCGCAGTTTGTTTTTGATGTAAAGAAGCCGGAGGATGAAGTCCTGGTTTGTCTCCAGCAGAAGACAAAGAGGACCACCCGGCAGGACGGGAAAGCAGAAAATCTCGCTATTGGTTTTGAAATTCACCAGGTGGAGTTGAACCGCAAGTTCCGGATGCACACCCTTCAGCCCAAAGTGGTCAGCTCCATCTACATTAACTCCCGCAGTGTCTTCCTACGTGTTGACCTGAAGGAAGGGAGATACCTCATTATTCCCACCACATTCGATCCTGGTCACACGGGCGAATTCCTTCTCAGAGTTTTTACTGATGAGCCTTCTAACTGCTGTGAACTGATATTGGATGAACCCACCAGGACGTGTTGGTCGGGTATGTGTGGGTACCCCCAGCTGGTGTCACAGGTGCATGTGGTCTCGGCCTTGGGACTCAAGAAGCAAGATTCCAACGGAGGTGCTGACCCGTACGTGATTATCTGCTGTGAAGGAAACAAAGTGCAGTCCCCTGTCATCAAAGACTGTTTGGATCCGAAATTTAATGTCAAAGGGGTTTTCTACAGGAAGAAGCCCGGGCAGCCCATTGTGGTTCAGGTTTGGAATCATAACGTTATAAAGGATGAGTTCATGGGACAGGTGGTCCTTTCTGCCGACCCCAACAACCTTCAGACTCAGCACAGCCTTGAGCTTCAGGACAAGGGCAACAAGAAATCTGGCACGATCTCAGGAACCGTCAACCTTATTCTGCTCACTAGCCAAAGCCTTACCGGGATATAATCTTCCTGTGGGGTGCCATTTTTAAAGGTGAAAATCCAGTCTCCATGTTACCCTTGAGGTGCCTTGAGGAAAGCCGAGACTTATTCTCCCGTTGGTCTTGTTTCCACCGGAGCTTGCCCGCTCCGCACCTGACTGTATGATATTCACTATATGCAATTCCATATACATGTGCCAAAAACTAACTGAACACAGCACCAATGTATCTATAGCCTAGATAGAAAGTTCTCTCTAGCATTTATACTATGTGTCTGCAATCTTCCCTGGATTCTCCTGTGCATAGTGACCCAGCTGAATTACAACAGCTCTGTAGTCTTATGTCACTATCCCAGTCTGTTCATGGCTACCCCACTACTGTGAGACGTCACTTGCCCTTTGATGTTTGTTGTGTTGCTGCAAATCTGCAGCATATTGGGCAAAGCTTGGCCATAGTGATTTATTTGGGTTGATATAAATCCTATAATAAATAAGCCATGCAGGAGCCAATAAAGGCTTCCAATTTGGTCCCTCTAGCTTATTGGGTCATGTGTGAGGTCCTCAGGAGGGCCTGCCCAACCAATACCTAGATGAAAATCAGCCAGATACCTGTTGTGCTTAACCCAACAGTAGGATTTTTGATATTGAGAATATTTCTCTGTGGCTTTAAGCACAAGACTTGTGTTAAACCCAACACCGTAACATGGCACACGACCAATAACACCATTTGACCTGCCACATGCACCTTCTTGTGTTTATAAATGAGCAGAGAACTCTTCCATAAAGACGGTATCAATTGGTTTCCCCATCCCTTATAAACTAGGATTTCTGGTTCTACTGGATCCAGCGATGCAGAATCCATCCAAGGTCACTGGTCCAGACCAGACTTCTGTAGAATAAGCCACGGCCATGTCTGAGGGCGGCATTTAGCTTTTATACGTAGAATAAGGGTTTAGATTTAGACCAAACTGTCAGTTCTGACCCCCTCAGGCCTGGACTGGACTCAGCACTCATGTTTCAGAACAATCGTTGAAGCCCAAATTTTGGCTTTCTCCAGGGGCCACAGGTTCTAGATCTAGTAGGAGAATGCAAAAATGATAATGTACAACGAGCGTCAACATGGGGATGTGGACATTGGACAGAAATCTCTCTAAGGGCTTCAATTTGTCATGCGTCTGTTTTTAGTGGACCAAACAACAAAATTCTGCAGTGATTCAGGTTTTATGCTATTTTATTTGTTTTAGGTAGTAAATAAAATAAGGTTTTAGGGAGGGAAACAATCTATTTGGCCAATGGACTTTTTCTTGTGCCAATGCTCCGAAGCAGAAGGGACCAATGATCTGATTCACCGGGACAGCCTTATGGTTCTGCCTAGTGATTGGACCAATTTGCTCGTTACTTGTGATAAATGGGATAATTCTCAGCACTTTGCAGTCAGCTTTACAGTAAGTGTCCCTACATTGACTTTAATAAGTCCTAAGTCCAATGAAGAGGGTCCCAATGCCAAATATTTTACAATGTTTTAAATGCACAATTACATATTCTTTTAAGTTCAGAGTTAAGTTTTTTTTTTGTTTGTTTTTTTGAAGTTGGTCTTTATTTGCCCAACACAGACAGCTGCTATTGGCTGCTGACTTGGCCACTAATGAAGGAGTTGACCGATTATTGGATAAAAGAGATCAGAGCTGATCAGGGTTTAATAAGATATCAGTCGACAATTCTGTCGTTTAAAGACCTCATTAGGCCATGAATTGGGTCAATAACAACCCCCCTATGTGATCCAGTCGCCTATTGGGTTGATGTGGCCGATCCGTCTGTCTATGGCTTCTTTATTCTCTCTGTTCTGTTATTCAGCACATGCAAACTGATGATGATGATGGTTTTATTCAGGGATGTTCAGTGTTTTATTTGGACGTTAATGTTGTTTATTTTATGGGTCTTTTTGAATTTAGCTTTTTTTTGTATTTCATTGTTTAATGATGAGTTCAAATCTCTTGTCTCCAAATCTTGTTCAAGGGAAACTTTTATATTAAATGTCTCTCTCTCCTTTGTTAAAAAAAAAAAAAAA


>cap5n.Z.maybe.scaffold125
ATGCAAACCCTTCAGCCCAAAGTGGCCAGCTCCATCTACATTAACTCTGGCAGTGTCTTCCTACACGTTGACCTGAAGGAGGGGAGATACGTCGTTATTCCCACCATGTTTAATCCTGGTGACACGGGAGAATTCCTGCTCAGAATTTTTACTGATGTGCTTTCTAACTTGCTTGTAAGTCAATATGGCCCCAACTAG
```



# Blastn 
```
#build blastn database index
makeblastdb -in /home/xue/borealis_DE/session_laevis_deNovo_transcriptome/laevis_session_transcriptome/laevis_session_trinityout.Trinity.fasta -dbtype nucl -out /home/xue/borealis_DE/session_laevis_deNovo_transcriptome/laevis_session_transcriptome/laevis_transcriptome

makeblastdb -in /home/xue/borealis_DE/session_laevis_deNovo_transcriptome/laevis_session_transcriptome/laevis_SRR2515140_trinity.Trinity.fasta -dbtype nucl -out /home/xue/borealis_DE/session_laevis_deNovo_transcriptome/laevis_session_transcriptome/laevis_SRR2515140

makeblastdb -in /home/xue/borealis_DE/session_laevis_deNovo_transcriptome/laevis_session_transcriptome/laevis_SRR2515162_trinity.Trinity.fasta -dbtype nucl -out /home/xue/borealis_DE/session_laevis_deNovo_transcriptome/laevis_session_transcriptome/laevis_SRR2515162


#mapping the gene with blastn
blastn -task blastn -db /home/xue/borealis_DE/session_laevis_deNovo_transcriptome/laevis_session_transcriptome/laevis_transcriptome/ -outfmt 6 -evalue 0.00005 -query  /home/xue/laevis_dosageCompensated_gene/cap5n.fasta -out /home/xue/laevis_dosageCompensated_gene/cap5n_blastout

blastn -task blastn -db /home/xue/borealis_DE/session_laevis_deNovo_transcriptome/laevis_session_transcriptome/laevis_SRR2515140 -outfmt 6 -evalue 0.00005 -query  /home/xue/laevis_dosageCompensated_gene/cap5n.fasta -out /home/xue/laevis_dosageCompensated_gene/cap5n_SRR2515140_blastout

blastn -task blastn -db /home/xue/borealis_DE/session_laevis_deNovo_transcriptome/laevis_session_transcriptome/laevis_SRR2515162 -outfmt 6 -evalue 0.00005 -query  /home/xue/laevis_dosageCompensated_gene/cap5n.fasta -out /home/xue/laevis_dosageCompensated_gene/cap5n_SRR2515162_blastout

```
Mapping the cap5n transcripts to the laevis genome with GMAP:
```
gmap -D /home/xue/genome_data/laevis_genome/db_gmap_xl92/ -d laevis92_gmap -A -Z -f sampe /home/xue/laevis_dosageCompensated_gene/cap5n.fasta > cap5n_gmap.sam
```
# Findings_summary
```
cap5n blast out: mapping cap5n transcripts to Session laevis transcriptome
qseqid sseqid pident length mismatch gapopen qstart qend sstart send evalue bitscore
cap5n.L TRINITY_DN104672_c2_g3_i1       99.377  2248    9       2       1871    4118    2243    1       0.0     3986
cap5n.L TRINITY_DN104672_c2_g1_i7       98.949  1903    12      1       1       1895    122     2024    0.0     3344
cap5n.S TRINITY_DN104672_c2_g4_i1       98.863  2198    13      4       1853    4050    2186    1       0.0     3844
cap5n.S TRINITY_DN104672_c2_g1_i9       98.616  1879    24      1       1       1877    298     2176    0.0     3268
cap5n.Z.maybe.scaffold125       TRINITY_DN104672_c2_g1_i10      92.899  169     12      0       1       169     1702    1870    7.12e-66        251
cap5n.Z.maybe.scaffold125       TRINITY_DN104672_c2_g1_i7       92.899  169     12      0       1       169     1550    1718    7.12e-66        251
cap5n.Z.maybe.scaffold125       TRINITY_DN104672_c2_g1_i3       92.899  169     12      0       1       169     1550    1718    7.12e-66        251

Differential expression analysis
Transcript_ID sampleA sampleB logFC   logCPM  PValue  FDR
TRINITY_DN104672_c2_g3_i1       female  male    1.73737435544078        5.47957694584551        0.373730970795105       0.978201621508316
TRINITY_DN104672_c2_g1_i7       female  male    1.74440671200361        5.04649600882707        0.382783779960891       0.983165339325821
TRINITY_DN104672_c2_g4_i1       female  male    0.772013492691367       3.27184956180954        0.738152855977356       1
TRINITY_DN104672_c2_g1_i10      female  male    1.25686812793178        2.83495963069712        0.560267220908873       1

TPM value (no TMM normalization)
Transcript_ID        female_liver2    female_ovary1    female_liver1    female_overy1   male_testis1    male_testis1
TRINITY_DN104672_c2_g3_i1       10.0864 18.4412 22.0408 21.0902 4.86178 10.0609
TRINITY_DN104672_c2_g1_i7       6.39446 13.2389 18.4739 20.008  3.08734 8.66474
TRINITY_DN104672_c2_g4_i1       0.522692        6.2701  1.62397 9.02281 1.79997 3.89733
TRINITY_DN104672_c2_g1_i9       0       0       0       0.00020696      0.256685        0.514706
TRINITY_DN104672_c2_g1_i10      0.392362        4.47085 1.17623 7.55298 0.895947        2.26558
TRINITY_DN104672_c2_g1_i3       0.219598        0       0.00555149      9.78637e-10     0.0447098       0.562059


TPM value with cross-sample normalization (TMM normalization)
Transcript_ID        female_liver2    female_ovary1    female_liver1    female_overy1   male_testis1    male_testis1
TRINITY_DN104672_c2_g3_i1       15.615  10.801  31.470  18.976  3.921   10.709
TRINITY_DN104672_c2_g1_i7       9.899   7.754   26.377  18.002  2.490   9.223
TRINITY_DN104672_c2_g4_i1       0.809   3.672   2.319   8.118   1.452   4.149
TRINITY_DN104672_c2_g1_i9       0.000   0.000   0.000   0.000   0.207   0.548
TRINITY_DN104672_c2_g1_i10      0.607   2.618   1.679   6.796   0.723   2.412
TRINITY_DN104672_c2_g1_i3       0.340   0.000   0.008   0.000   0.036   0.598

GMAP: mapping the cap5N sequences (ones that you send me) to the laevis genome; in sam file format 
cap5n.L 81      chr2L   180089115       40      
cap5n.S 81      chr2S   154204220       40      
cap5n.Z.maybe.scaffold125       81      Scaffold125     65935   40      
cap5n.Z.maybe.scaffold125       65      chr2L   179697453       6    

```
